<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>20/10 with u</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap-grid.min.css"
        integrity="sha512-JQksK36WdRekVrvdxNyV3B0Q1huqbTkIQNbz1dlcFVgNynEMRl0F8OSqOGdVppLUDIvsOejhr/W5L3G/b3J+8w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="loveletter.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

    <style>
        .container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 97vh;
        }

        .container svg {
            width: 50%;
            height: 50%;
        }
    </style>

    <!-- aa2 -->
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .hover-animation {
            animation: hover 1.75s ease-in-out infinite;
        }
        .dustDef {
            position: absolute;
            background-color: white;
            border-radius: 100%;
            box-shadow: 0 0 3px 1px white;
            opacity: 0;
        }

        @keyframes hover {
            0% {
                margin-top: 60px;
            }

            50% {
                margin-top: 50px;
            }

            100% {
                margin-top: 60px;
            }
        }

        @keyframes glow {
            0% {
                box-shadow: 0 0 25px 0 #e8b2ca;
            }

            50% {
                box-shadow: 0 0 45px 0 #e8b2ca;
            }

            100% {
                box-shadow: 0 0 25px 0 #e8b2ca;
            }
        }

        @keyframes fall {
            5% {
                top: 209px;
                left: 105px;
                transform: rotate(55deg) scale(0.9, 0.95) skew(-18deg);
                opacity: 0.9;
            }

            30% {
                left: 90px;
            }

            55% {
                left: 130px;
            }

            60%,
            100% {
                top: 380px;
                transform: rotate(30deg) scale(0.9, 0.95) skew(-32deg);
                opacity: 0;
            }
        }

        @keyframes floatAnimate {
            0% {
                background-size: 105% 120%;
                background-position: 0 0;
                opacity: 0.7;
            }

            50% {
                background-size: 100% 100%;
                background-position: 0 0;
                opacity: 0.5;
            }

            100% {
                background-size: 105% 120%;
                background-position: 0 0;
                opacity: 0.7;
            }
        }
    </style>
    <style>
        svg {

            width: 100%;
            display: block;
            position: absolute;
            margin: auto;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1;
        }

        text {
            fill: #e6668a;
            font-family: consolas;
            font-size: 11px;
        }

        p {
            position: absolute;
            z-index: 2
        }

        label {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            opacity: .8
        }
    </style>
    <style>
        /* CSS Thuần - Thay thế cho Tailwind CSS */

        /* Cài đặt chung & Reset */


        /* Keyframes Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes gentle-shake {
            0%, 100% { transform: rotate(3deg); }
            50% { transform: rotate(1deg); }
        }

        @keyframes float-up {
            from { transform: translateY(0); opacity: 0.7; }
            to { transform: translateY(-110vh); opacity: 0; }
        }

        /* Container chính của thiệp */
        .card-container {
            width: 100%;
            max-width: 42rem; /* Tương đương max-w-2xl */
            position: relative;
            z-index: 10;
            animation: fadeIn 0.7s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }

        /* Lớp vỏ ngoài của thiệp */
        .card-info {
            background-color: #FFF1F2; /* Màu nền hồng nhạt */
            border: 1px solid #FECDD3;
            border-radius: 1rem; /* bo góc */
            position: relative;
            margin: 0.7rem;
            /* Đổ bóng nhiều lớp */
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1), 0 0 0 5px #FFF1F2, 0 0 0 6px #FECDD3;
        }
        
        .card-inner {
            position: relative;
            padding: 1.5rem;
        }

        /* Trái tim trang trí góc trên */
        .decorative-heart {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: #f9a8d4; /* pink-300 */
            opacity: 0.6;
            width: 1.5rem;
            height: 1.5rem;
        }

        /* Vùng chứa nội dung (chữ và ảnh) */
        .content-wrapper {
            font-family: 'Great Vibes', cursive;
            position: relative;
            z-index: 10;
            height: 65vh;
            max-height: 550px;
            min-height: 450px;
        }

        /* Vùng chứa văn bản có thể cuộn */
        .text-scrollbox {
            position: absolute;
            top: 0; right: 0; bottom: 8rem; left: 0;
            overflow-y: auto;
            padding-bottom: 16rem; /* Không gian cho ảnh */
            padding-right: 0.75rem; /* Không gian cho thanh cuộn */
        }
        
        .card-title {
            font-family: 'Great Vibes', cursive;
            font-size: 2.25rem;
            line-height: 2.5rem;
            color: #ec4899; /* pink-500 */
            overflow-wrap: break-word;
        }

        .card-body-text {
            margin-top: 1rem;
            color: black; /* gray-600 */
            line-height: 1.625;
            font-size: 1.2rem;
            white-space: pre-wrap;
        }
        
        /* Ảnh Polaroid */
        .polaroid-container {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 150px; /* w-40 */
            height: 150px; /* h-48 */
            /* transition: transform 0.3s ease-in-out;
            animation: gentle-shake 5s ease-in-out infinite; */
        }
        .polaroid-container-left {
                position: absolute;
                bottom: 0rem;
                left: -2rem;
                width: 12rem;
                height: 11.8rem;
                object-fit: cover;
                border-radius: 0.5rem;
                    transform: rotate(20deg); /* xoay phải */
    transform-origin: center; 
        }
        .polaroid-container-top {
               opacity: 0.3;
                position: absolute;
                top: -2rem;
                left: -2rem;
                width: 12rem;
                height: 11.8rem;
                object-fit: cover;
                border-radius: 0.5rem;
        }

        .polaroid-container:hover {
            transform: rotate(0) scale(1.05);
            animation-play-state: paused; /* Dừng lắc khi hover */
        }

        .polaroid-frame {
            background-color: white;
            padding: 0.5rem;
            padding-bottom: 2rem;
            border-radius: 0.375rem;
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 8px 10px -6px rgba(0,0,0,0.1);
            width: 150px;
            height: 150px;   
            display: flex;
            transform: rotate(15deg); /* ✅ xoay sang phải 5 độ */
    transform-origin: center;
            flex-direction: column;
        }
        .polaroid-frame-left{
            padding: 0.5rem;
            padding-bottom: 2rem;
            border-radius: 0.375rem;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        
        .polaroid-image-wrapper {
            width: 100%;
            flex-grow: 1;
            border-radius: 0.125rem;
            position: relative;
        }

        .polaroid-image {
              width: 150px;
          height: 150px; 
            /* position: absolute; */
            width: 100%;
            /* height: 100%; */
            object-fit: cover;
            border-radius: 0.125rem;
        }
        .polaroid-image-left {
        position: absolute;
        bottom: 0rem;     /* đẩy xuống dưới một chút */
        left: 0rem;       /* ra ngoài khung một chút */
        width: 12rem;      /* hoặc lớn hơn tùy bố cục */
        height: 11.8rem;   /* giữ tỷ lệ gần vuông */
        object-fit: cover; /* giữ tỉ lệ ảnh, không méo */
        border-radius: 0.5rem;
        }
        
        .polaroid-caption {
            text-align: center;
            font-family: 'Great Vibes', cursive;
            color: #6B7280; /* gray-500 */
            padding-top: 0.75rem;
            font-size: 1.125rem;
            flex-shrink: 0;
        }

        /* Hiệu ứng trái tim bay */
        #hearts-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }
        .heart {
            position: absolute;
            bottom: -10vh;
            color: #f472b6; /* rose-400 */
            opacity: 0.7;
            animation: float-up linear forwards;
        }

        /* Thanh cuộn tùy chỉnh */
        .text-scrollbox::-webkit-scrollbar { width: 6px; }
        .text-scrollbox::-webkit-scrollbar-track { background: transparent; }
        .text-scrollbox::-webkit-scrollbar-thumb {
            background-color: #f9a8d4; /* pink-300 */
            border-radius: 20px;
        }

        /* Responsive cho màn hình nhỏ hơn (sm) */
        @media (min-width: 640px) {
            .card-inner {
                padding: 2rem;
            }
            .text-scrollbox {
                padding-bottom: 14rem;
            }
            .polaroid-container {
                width: 11rem; /* w-44 */
                height: 13rem; /* h-52 */
            }
        }
    </style>
</head>

<body>

    <main class="card-container" style="display: none;" >
        <div class="card-info">
            <div class="card-inner">
                <div class="decorative-heart">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" /></svg>
                </div>
                
                <div class="content-wrapper">
                    <div class="text-scrollbox">
                        <h1 class="card-title">Gửi em,</h1>
                        <p class="card-body-text">Nhân ngày 20/10, chúc cho người phụ nữ tuyệt vời nhất của anh luôn xinh đẹp, rạng rỡ và ngập tràn hạnh phúc. Cảm ơn em đã đến và khiến cuộc sống của anh trở nên thật ý nghĩa. Mỗi ngày trôi qua, anh càng nhận ra mình may mắn đến nhường nào khi có em ở bên. Em là nguồn động lực vô tận của anh. Chúc em một ngày thật vui vẻ và đáng nhớ! Mong những điều tốt đẹp nhất sẽ đến với em, không chỉ trong hôm nay mà còn trong mỗi khoảnh khắc của cuộc đời. Yêu em rất nhiều!</p>
                    </div>

                    <div class="polaroid-container">
                        <div class="polaroid-frame">
                            <div class="polaroid-image-wrapper">
                                <img src="https://i.pinimg.com/736x/a3/50/92/a35092722ac45b049e14bb4ae01653b2.jpg" alt="Kỷ niệm" class="polaroid-image">
                            </div>
                        </div>
                        
                    </div>
                        <div class="polaroid-container-top">
                        <div class="polaroid-frame-left">
                            <div class="polaroid-image-wrapper-left">
                                <img src="./pngegg1.png" alt="Kỷ niệm" class="polaroid-image-left">
                            </div>
                        </div>
                        
                    </div>
                       </div>
                        <div class="polaroid-container-left">
                        <div class="polaroid-frame-left">
                            <div class="polaroid-image-wrapper-left">
                                <img src="./mewmew.gif" alt="Kỷ niệm" class="polaroid-image-left">
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </main>

    <svg style="display: none;" id="theSvg" viewBox="-120 -30 240 180" enable-background="new 0 0 174 148"
        xml:space="preserve">
        <defs>
            <filter id="f" filterUnits="userSpaceOnUse" x="-120" y="-30" width="120%" height="120%">
                <feGaussianBlur in="SourceAlpha" stdDeviation="5" result="blur"></feGaussianBlur>
                <feOffset in="blur" dx="3" dy="5" result="shadow"></feOffset>
                <feFlood flood-color="rgba(3,0,0,1)" result="color" />
                <feComposite in="color" in2="shadow" operator="in" />
                <feComposite in="SourceGraphic" />
            </filter>
            <path id="shape" d="M0, 21.054 
       C0, 21.054 24.618, -15.165 60.750, 8.554 
       C93.249, 29.888 57.749, 96.888 0, 117.388
       C-57.749, 96.888  -93.249, 29.888 -60.750, 8.554
       C-24.618, -15.165  -0, 21.054 -0, 21.054z    
    " 
    stroke="hotpink"
        stroke-width="3"
        fill="none"
        transform="scale(1.3)" />
            <path id="partialPath" transform="scale(1.2)" />

        </defs>

        <text dy="-5">
            <textPath style="font-family: fantasy;" xlink:href="#partialPath" startOffset="12">
                Happy Women's Day
                🌹......................Yêu Em..........................................................................................................................................................................................................................................................
            </textPath>
        </text>

        <use id="useThePath" xlink:href="#partialPath" stroke="white" stroke-width=".5" stroke-opacity=".5" fill="none"
            style="display:none;" />
    </svg>

    <script>
        let rid = null; // request animation id
        const SVG_NS = "http://www.w3.org/2000/svg";
        const pathlength = shape.getTotalLength();

        let t = 0; // at the begining of the path
        let lengthAtT = pathlength * t;

        let d = shape.getAttribute("d");

        // 1. build the d array
        let n = d.match(/C/gi).length; // how many times

        let pos = 0; // the position, used to find the indexOf the nth C

        class subPath {
            constructor(d) {
                this.d = d;
                this.get_PointsRy();
                this.previous = subpaths.length > 0 ? subpaths[subpaths.length - 1] : null;
                this.measurePath();
                this.get_M_Point(); //lastPoint
                this.lastCubicBezier;
                this.get_lastCubicBezier();
            }

            get_PointsRy() {
                this.pointsRy = [];
                let temp = this.d.split(/[A-Z,a-z\s,]/).filter(v => v); // remove empty elements
                temp.map(item => {
                    this.pointsRy.push(parseFloat(item));
                }); //this.pointsRy numbers not strings
            }

            measurePath() {
                let path = document.createElementNS(SVG_NS, "path");
                path.setAttributeNS(null, "d", this.d);
                // no need to append it to the SVG
                // the lengths of every path in dry
                this.pathLength = path.getTotalLength();
            }

            get_M_Point() {
                if (this.previous) {
                    let p = this.previous.pointsRy;
                    let l = p.length;
                    this.M_point = [p[l - 2], p[l - 1]];
                } else {
                    let p = this.pointsRy;
                    this.M_point = [p[0], p[1]];
                }
            }

            get_lastCubicBezier() {
                let lastIndexOfC = this.d.lastIndexOf("C");
                let temp = this.d
                    .substring(lastIndexOfC + 1)
                    .split(/[\s,]/)
                    .filter(v => v);
                let _temp = [];
                temp.map(item => {
                    _temp.push(parseFloat(item));
                });
                this.lastCubicBezier = [this.M_point];
                for (let i = 0; i < _temp.length; i += 2) {
                    this.lastCubicBezier.push(_temp.slice(i, i + 2));
                }
            }
        }

        let subpaths = [];

        // create new subPaths
        for (let i = 0; i < n; i++) {
            // finds the of nth C in d
            let newpos = d.indexOf("C", pos + 1);
            if (i > 0) {
                // if it's not the first C
                let sPath = new subPath(d.substring(0, newpos));
                subpaths.push(sPath);
            }
            //change the value of the position pos
            pos = newpos;
        }
        // at the end add d to the subpaths array
        subpaths.push(new subPath(d));

        // 2. get the index of the bezierLengths where the point at t is
        let index;
        for (index = 0; index < subpaths.length; index++) {
            if (subpaths[index].pathLength >= lengthAtT) {
                break;
            }
        }

        function get_T(t, index) {
            let T;
            lengthAtT = pathlength * t;
            if (index > 0) {
                T =
                    (lengthAtT - subpaths[index].previous.pathLength) /
                    (subpaths[index].pathLength - subpaths[index].previous.pathLength);
            } else {
                T = lengthAtT / subpaths[index].pathLength;
            }
            //console.log(T)
            return T;
        }

        let T = get_T(t, index);

        let newPoints = getBezierPoints(T, subpaths[index].lastCubicBezier);

        drawCBezier(newPoints, partialPath, index);

        function getBezierPoints(t, points) {
            let helperPoints = [];

            // helper points 0,1,2
            for (let i = 1; i < 4; i++) {
                //points.length must be 4 !!!
                let p = lerp(points[i - 1], points[i], t);
                helperPoints.push(p);
            }

            // helper points 3,4
            helperPoints.push(lerp(helperPoints[0], helperPoints[1], t));
            helperPoints.push(lerp(helperPoints[1], helperPoints[2], t));

            // helper point 5 is where the first Bézier ends and where the second Bézier begins
            helperPoints.push(lerp(helperPoints[3], helperPoints[4], t));

            // points for the dynamic bézier
            let firstBezier = [
                points[0],
                helperPoints[0],
                helperPoints[3],
                helperPoints[5]
            ];
            //console.log(firstBezier)
            return firstBezier;
        }

        function lerp(A, B, t) {
            // a virtual line from A to B
            // get the position of a point on this line
            // if(t == .5) the point in in the center of the line
            // 0 <= t <= 1
            let ry = [
                (B[0] - A[0]) * t + A[0], //x
                (B[1] - A[1]) * t + A[1] //y
            ];
            return ry;
        }

        function drawCBezier(points, path, index) {
            let d;

            if (index > 0) {
                d = subpaths[index].previous.d;
            } else {
                d = `M${points[0][0]},${points[0][1]} C`;
            }

            // points.length == 4
            for (let i = 1; i < 4; i++) {
                d += ` ${points[i][0]},${points[i][1]} `;
            }
            //console.log(d)
            partialPath.setAttributeNS(null, "d", d);
        }

        /*
        _t.addEventListener("input", ()=>{
          t = _t.value;
          lengthAtT = pathlength*t;
          for(index = 0; index < subpaths.length; index++){
        if(subpaths[index].pathLength >= lengthAtT){break; }  
        }
          T = get_T(t, index); 
          newPoints = getBezierPoints(T,subpaths[index].lastCubicBezier);
          drawCBezier(newPoints, partialPath, index);
        })*/

        t = 0.025;


        Typing();
        theSvg.addEventListener("click", () => {
            if (rid) {
                window.cancelAnimationFrame(rid);
                rid = null;
            } else {
                if (t >= 1) {
                    t = 0.025;
                }
                rid = window.requestAnimationFrame(Typing);
            }
        });

        // cb.addEventListener("input", () => {
        //     if (cb.checked) {
        //         useThePath.style.display = "block";
        //     } else {
        //         useThePath.style.display = "none";
        //     }
        // });
    </script>
            <div id="heart1" style="display: none;"> </div>


            <div id="container-valen" style="display: none;">  
            <div class="valentines">
            <div class="envelope"></div>
            <div class="front"></div>
            <div class="card">
            <div class="text">To my</br>Crush </br>I love You!</div>
            <div class="heart">
            </div>
            <div class="hearts">
                <div class="one"></div>
                <div class="two"></div>
                <div class="three"></div>
                <div class="four"></div>
                <div class="five"></div>
            </div>
            </div>
            </div>
<div class="shadow"></div>
</div>
    </div>


    <div class="container" id="rose-t">
        <svg viewBox="0 0 512 512">
            <path class="leafOne" d="M124.302,328.222c-2.466-2.901-5.036-5.334-7.648-7.212c-1.884-1.354-4.49-1.207-6.201,0.36
                                    c-32.608,29.866-18.892,84.017,24.01,94.752c2.251,0.563,4.612-0.548,5.624-2.636c0.407-0.841,0.781-1.732,1.138-2.648
                                    C111.438,394.378,103.302,355.204,124.302,328.222z" />
            <path class="stickLine"
                d="M337.625,212.314c2.37-3.44,1.501-8.149-1.939-10.519c-3.44-2.369-8.15-1.501-10.519,1.939
                                     c-19.493,28.304-43.492,60.076-72.147,92.853l-2.542-30.875c-0.343-4.163-4-7.261-8.158-6.917c-4.163,0.343-7.26,3.995-6.917,8.158
                                     l3.721,45.196C172.176,385.546,93.558,449.444,4.053,496.37c-3.699,1.94-5.127,6.512-3.187,10.211
                                     c1.352,2.579,3.983,4.054,6.705,4.054c1.183,0,2.385-0.279,3.505-0.867c63.84-33.47,124.784-76.962,181.511-129.479
                                     c5.891-2.031,32.15-10.225,68.671-8.819c4.156,0.167,7.689-3.09,7.85-7.266c0.161-4.174-3.092-7.689-7.267-7.849
                                     c-18.678-0.721-34.824,0.89-47.384,3.036C259.688,314.785,301.126,265.31,337.625,212.314z" />
            <path class="leafTwo" d="M329.58,413.715c30.055,1.827,57.188-13.413,71.993-37.343c1.738-2.81,1.253-6.495-1.142-8.771
                                   c-13.04-12.394-37.78-21.675-66.625-23.428s-54.527,4.464-68.972,15.187c-2.653,1.969-3.581,5.568-2.196,8.568
                                   C274.438,393.475,299.525,411.888,329.58,413.715z" />
            <path class="leafS1" d="M370.677,231.945c-8.984-2.411-17.479-7.138-24.516-14.205c-5.085-5.106-8.742-10.981-11.143-17.242
                                  c-6.645,0.902-13.554,0.516-20.475-1.491c-9.578-2.778-17.805-7.959-24.234-14.68c-12.216,1.01-22.611,4.593-28.859,9.642
                                  c-1.416,1.145-1.839,3.149-0.999,4.772c7.157,13.821,21.478,23.41,38.131,23.745c11.548,0.232,22.109-4.035,30.031-11.178
                                  c-2.461,10.379-1.13,21.692,4.621,31.709c8.293,14.445,23.583,22.401,39.142,22.039c1.826-0.042,3.382-1.376,3.705-3.168
                                  C377.509,253.982,375.658,243.144,370.677,231.945z" />
            <path class="rose1" d="M508.212,99.848c-2.666-4.581-27.324-44.843-71.558-48.206c-4.268-0.223-8.58-0.164-12.816,0.176
                                l-1.148,0.092l0.471,1.051c7.005,15.648,9.002,31.447,7.106,48.307l0.877,0.04c11.782,0.538,23.679,3.513,35.362,8.841l0.367,0.168
                                l0.355-0.188c10.841-5.728,22.445-6.783,35.477-3.225C506.927,108.058,510.397,103.599,508.212,99.848z M452.476,54.541c-4.96-1.457-10.233-2.474-15.823-2.899c-4.268-0.223-8.58-0.164-12.816,0.176
                                l-1.148,0.092l0.471,1.051c7.005,15.648,9.002,31.447,7.106,48.307l0.877,0.04c9.334,0.426,18.74,2.407,28.055,5.851
                                C461.04,88.852,458.784,71.19,452.476,54.541z" />

            <path class="rose2" d="M418.642,40.96c-24.19-37.169-71.346-39.455-76.643-39.593c-4.34-0.114-6.582,5.071-3.543,8.22
                                 c9.38,9.721,14.029,20.406,14.212,32.665l0.005,0.402l0.324,0.242c13.637,10.194,23.714,22.558,29.944,36.731
                                 c4.198,10.201,6.37,19.468,7.545,29.411l0.996-0.402c8.962-3.617,18.525-6.008,28.405-7.105c3.688-0.322,7.481-0.397,11.274-0.223
                                 l0.762,0.035C434.378,79.498,430.171,59.623,418.642,40.96z " />

            <path class="rose3" d="M343.8,146.676c13.018-17.726,29.06-30.524,47.682-38.039l0.576-0.232
                                 c-1.161-9.857-3.49-19.395-7.611-29.408c-20.694-47.084-74.317-58.577-80.363-59.731c-4.853-0.927-8.31,4.471-5.489,8.546
                                 c21.533,31.149,7.895,59.383-14.633,90.009l0.071,0.029c-16.953,26.497-7.863,61.237,18.513,76.865
                                 c3.932,2.33,8.219,4.207,12.806,5.537c6.757,1.959,13.752,2.469,20.787,1.514l1.017-0.138l-0.367-0.959
                                 C330.327,183.817,333.08,162.625,343.8,146.676z" />

            <path class="rose4"
                d="M510.726,141.7c-3.917-4.747-39.75-46.26-91.009-41.792c-21.664,2.405-52.653,12.308-77.277,45.856
                                 c-13.392,19.922-16.495,52.272,4.132,72.986c3.371,3.385,7.075,6.243,11.008,8.573c26.325,15.597,61.186,6.961,76.309-20.683
                                 l0.077,0.062c15.307-34.399,34.961-59.933,71.9-56.082C510.802,151.136,513.867,145.507,510.726,141.7z M370.903,162.627c27.904-38.017,75.307-57.751,121.144-38.743
                                 c-16.072-12.613-41.381-26.674-72.329-23.977c-21.664,2.405-52.653,12.308-77.277,45.856c-13.392,19.922-16.495,52.272,4.132,72.986
                                 c3.371,3.385,7.075,6.243,11.008,8.573c4.885,2.894,10.125,4.964,15.515,6.228C354.624,212.802,357.947,181.899,370.903,162.627z" />
        </svg>
        <p id="text-click" style=" display: none;   font-family: 'Great Vibes', cursive;
        color: indianred;
        font-size: 30px;
        top: 80%;">Embe ấn vào đây nhé</p>
    </div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/2.0.2/anime.min.js"></script>

    <!-- aa3 -->
    <script>

        (() => {
            setTimeout(() => {
                document.querySelector("#text-click").style.display="inherit";
            }, 4000);
            document.querySelector("#rose-t").onclick = function () {
                document.querySelector("#rose-t").style.display = "none";
                document.querySelector("#heart1").style.display = "inherit";
                document.querySelector("#theSvg").style.display = "inherit"

                rid = window.requestAnimationFrame(Typing);
                function Typing() {
                    rid = window.requestAnimationFrame(Typing);
                    if (t >= 1) {
                        window.cancelAnimationFrame(rid);
                        rid = null;
                                        document.querySelector("#heart1").style.display = "none";
                document.querySelector("#theSvg").style.display = "none"
                 document.querySelector("#container-valen").style.display = "inherit"
                    } else {
                        t += 0.0025;
                    }

                    lengthAtT = pathlength * t;
                    for (index = 0; index < subpaths.length; index++) {
                        if (subpaths[index].pathLength >= lengthAtT) {
                            break;
                        }
                    }
                    T = get_T(t, index);
                    newPoints = getBezierPoints(T, subpaths[index].lastCubicBezier);
                    drawCBezier(newPoints, partialPath, index);
                }
            }
            const head = document.getElementsByTagName('head')[0];
            let animationId = 1;

            function CreateMagicDust(x1, x2, y1, y2, sizeRatio, fallingTime, animationDelay, node = 'main') {
                let dust = document.createElement('span');
                let animation = document.createElement('style');
                animation.innerHTML = '\
      @keyframes blink' + animationId + '{\
          0% {\
              top: ' + y1 + 'px;\
              left: ' + x1 + 'px;\
              width: ' + 2 * sizeRatio + 'px;\
              height: ' + 2 * sizeRatio + 'px;\
              opacity: .4\
          }\
          20% {\
              width: ' + 4 * sizeRatio + 'px;\
              height: ' + 4 * sizeRatio + 'px;\
              opacity: .8\
          }\
          35% {\
              width: ' + 2 * sizeRatio + 'px;\
              height: ' + 2 * sizeRatio + 'px;\
              opacity: .5\
          }\
          55% {\
              width: ' + 3 * sizeRatio + 'px;\
              height: ' + 3 * sizeRatio + 'px;\
              opacity: .7\
          }\
          80% {\
              width: ' + sizeRatio + 'px;\
              height: ' + sizeRatio + 'px;\
              opacity: .3\
          }\
          100% {\
              top: ' + y2 + 'px;\
              left: ' + x2 + 'px;\
              width: ' + 0 + 'px;\
              height: ' + 0 + 'px;\
              opacity: .1\
          }}';
                head.appendChild(animation);
                dust.classList.add('dustDef');
                dust.setAttribute('style', `animation: blink${animationId++} ${fallingTime}s cubic-bezier(.71, .11, .68, .83) infinite ${animationDelay}s`);
                document.getElementByIFtod(node).appendChild(dust);
            }

            // yes, I'm doing it manually to get the effect I want.. can be easily changed to render randomly
            [[130, 132, 150, 152, .15, 2.5, .1, 'sub'],
            [65, 63, 300, 299, .5, 2, .2, 'sub'],
            [70, 70, 150, 150, .45, 2, .5],
            [75, 78, 160, 170, .6, 2, 1],
            [80, 82, 160, 180, .6, 1, .4],
            [85, 100, 160, 170, .5, 2, .5],
            [125, 110, 170, 180, .25, 3, 1.5],
            [90, 90, 115, 115, .4, 2, 2],
            [93, 95, 200, 200, .4, 3, 1.5],
            [100, 100, 145, 155, .45, 1, .5],
            [100, 90, 170, 230, .35, 2, .75],
            [100, 102, 115, 112, .35, 3, .25],
            [100, 95, 170, 200, .55, 1.5, .75],
            [100, 97, 150, 190, .7, 2, 1.5],
            [105, 100, 160, 180, .5, 1.5, .725],
            [125, 125, 180, 190, .25, 1, .725],
            [130, 130, 135, 135, .45, 3, 1.5],
            [135, 132, 170, 190, .25, 2.5, .75],
            [135, 132, 320, 315, .2, 5, .3, 'sub']
            ].forEach((o) => CreateMagicDust(...o));

        })();
    </script>

    <script>
        var leafOne = document.querySelector('.leafOne');
        var stickLine = document.querySelector('.stickLine');
        var leafTwo = document.querySelector('.leafTwo');
        var leafS1 = document.querySelector('.leafS1');
        var rose1 = document.querySelector('.rose1');
        var rose2 = document.querySelector('.rose2');
        var rose3 = document.querySelector('.rose3');
        var rose4 = document.querySelector('.rose4');

        var lineDrawing = anime({
            targets: [leafOne, stickLine, leafTwo, leafS1, rose1, rose2, rose3, rose4],
            strokeDashoffset: [anime.setDashoffset, 0],
            easing: 'easeInOutCubic',
            duration: 4000,
            begin: function (anim) {
                //Leaf One
                leafOne.setAttribute("stroke", "black");
                leafOne.setAttribute("fill", "none");
                // Leaf Two
                leafTwo.setAttribute("stroke", "black");
                leafTwo.setAttribute("fill", "none");
                //Stick
                stickLine.setAttribute("stroke", "black");
                stickLine.setAttribute("fill", "none");
                // Leaf S1
                leafS1.setAttribute("stroke", "black");
                leafS1.setAttribute("fill", "none");
                //Rose One
                rose1.setAttribute("stroke", "black");
                rose1.setAttribute("fill", "none");
                //Rose Two
                rose2.setAttribute("stroke", "black");
                rose2.setAttribute("fill", "none");
                //Rose Three
                rose3.setAttribute("stroke", "black");
                rose3.setAttribute("fill", "none");
                //Rose Three
                rose4.setAttribute("stroke", "black");
                rose4.setAttribute("fill", "none");
            },
            complete: function (anim) {
                //Leaf One
                leafOne.setAttribute("fill", "#9CDD05");
                leafOne.setAttribute("stroke", "none");
                //Leaf Two 
                leafTwo.setAttribute("fill", "#9CDD05");
                leafTwo.setAttribute("stroke", "none");
                //Stick
                stickLine.setAttribute("fill", "#83AA2E");
                stickLine.setAttribute("stroke", "none");
                // Leaf S1
                leafS1.setAttribute("fill", "#9CDD05");
                leafS1.setAttribute("stroke", "none");
                // Rose 1
                rose1.setAttribute("fill", "#F37D79");
                rose1.setAttribute("stroke", "none");
                // Rose 2
                rose2.setAttribute("fill", "#D86666");
                rose2.setAttribute("stroke", "none");
                // Rose 3
                rose3.setAttribute("fill", "#F37D79");
                rose3.setAttribute("stroke", "none");
                // Rose 3
                rose4.setAttribute("fill", "#D86666");
                rose4.setAttribute("stroke", "none");
            },
            autoplay: true,
        });

        document.addEventListener("click", function playMusicOnce() {
        const music = document.getElementById("bg-music");
        music.loop = true; 
        
        if (music.paused) {
            music.play().catch((e) => {
            console.log("Trình duyệt chặn tự phát:", e);
            });
        }

        // Sau khi click phát nhạc xong, gỡ event listener để không lặp lại
        document.removeEventListener("click", playMusicOnce);
        });
    </script> 
      <script src="loveletter.js"></script>
      <audio id="bg-music" src="./audio.mp3" preload="auto"></audio>

      <script>
        document.addEventListener('DOMContentLoaded', () => {
  // code xử lý dữ liệu ở đây
  const sheetId = '1VnLr3v5I-VGequ8i4YHwuKxwe8Kn0r1hLC1AE5TW-_w';
  const sheetName = 'Sheet1';
  const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;

  const params = new URLSearchParams(window.location.search);
  const targetCode = params.get('code'); // ví dụ: ?code=2

  fetch(url)
    .then(res => res.text())
    .then(text => {
      const json = JSON.parse(text.substr(47).slice(0, -2));
      const rows = json.table.rows;

      // Chuyển sang object đơn giản
      const data = rows.map(r => ({
        code: r.c[0]?.v ?? null,
        title: r.c[1]?.v ?? null,
        message: r.c[2]?.v ?? null,
        imageUrl: r.c[3]?.v ?? null,
        audioUrl: r.c[4]?.v ?? null,
        receiver: r.c[5]?.v ?? null
      }));

      // 🔍 Nếu có ?code= → lấy dòng đó
      let result = targetCode
        ? data.find(item => item.code?.toString() === targetCode)
        : null; // nếu không có thì lấy dòng đầu tiên

      if (!result) {
        console.error('❌ Không tìm thấy dữ liệu phù hợp');
        return;
      }

      // ✅ Trả ra 1 object duy nhất
      console.log('✅ Dữ liệu:', result);


        document.querySelector('.card-title').textContent = result.title || 'Gửi em,';
        document.querySelector('.card-body-text').textContent = result.message || '';

        const img = document.querySelector('.polaroid-image');
        console.log(img)
        if (result.imageUrl) {
          img.src = result.imageUrl;
        }
        const audio = document.getElementById('bg-music');
        if (result.audioUrl) {
          audio.src = result.audioUrl;
        }
        if(result.receiver) {
            document.querySelector('.text').innerHTML = result.receiver;
        }

      // (Tùy chọn) in trực tiếp ra web
      // document.body.innerText = JSON.stringify(result, null, 2);
    })
    .catch(err => console.error('Lỗi khi đọc dữ liệu:', err));
});

</script>
</body>

</html>